fragment messageFields on Message {
  message,
  sender {
    userId, displayName
  },
  timestamp,
  conversationId
}

fragment conversationFields on Conversation {
  messages {
    ...messageFields
  },
  conversationId,
  users {
    userId, displayName, email, phoneNumber
  }
}

subscription newMessage($conversationId: String!) {
  newMessage(conversationId: $conversationId) {
    ...messageFields
  }
}

mutation registerUserWithEmail{
  registerUserWithEmail {
    userId,
    displayName,
    email
  }
}

mutation registerUserWithPhoneNumber{
  registerUserWithPhoneNumber {
    userId,
    displayName,
    phoneNumber
  }
}

mutation postMessage($conversationId: String!, $message: String!) {
	postMessage(conversationId: $conversationId, message: $message){
		...messageFields
	}
}

mutation updateUser($displayName: String!) {
	updateUser(displayName: $displayName){
    userId,
    displayName,
    phoneNumber,
    email
	}
}

mutation initiateConversation($others:[String]) {
  initiateConversation(others: $others)
}

query getConversation($conversationId: String!, $since: String) {
	getConversation(conversationId: $conversationId, since: $since) {
		...conversationFields
	}
}

query lookupUserByPhoneNumber($phoneNumber: String!) {
	lookupUserByPhoneNumber(phoneNumber: $phoneNumber){
    userId,
    displayName,
    phoneNumber
	}
}

query lookupUserByEmail($email: String!) {
	lookupUserByEmail(email: $email){
    userId,
    displayName,
    email
	}
}

query getConversationHistory {
	getConversationHistory {
    ...conversationFields
	}
}
